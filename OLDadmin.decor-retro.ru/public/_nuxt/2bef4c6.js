(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{428:function(e,t,r){"use strict";r.r(t);var o={props:{title:{type:String,default:""},items:{type:Array,default:function(){return[]}}},data:function(){return{monthName:"",day:""}},mounted:function(){var e=new Date;this.monthName=["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"][e.getMonth()],this.day=e.getDate()}},l=r(2),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"kt-subheader   kt-grid__item",attrs:{id:"kt_subheader"}},[r("div",{staticClass:"kt-container  kt-container--fluid "},[r("div",{staticClass:"kt-subheader__main"},[r("h3",{staticClass:"kt-subheader__title"},[e._v(e._s(e._f("capitalize")(e.title)))]),e._v(" "),r("span",{staticClass:"kt-subheader__separator kt-hidden"}),e._v(" "),r("div",{staticClass:"kt-subheader__breadcrumbs"},[r("n-link",{staticClass:"kt-subheader__breadcrumbs-home",attrs:{to:{path:"/"}}},[r("i",{staticClass:"flaticon2-shelter"})]),e._v(" "),e._l(e.items,(function(t,i){return[r("span",{staticClass:"kt-subheader__breadcrumbs-separator"}),e._v(" "),r("n-link",{staticClass:"kt-subheader__breadcrumbs-link",attrs:{to:{name:t.name,params:t.params}}},[e._v("\n                    "+e._s(e._f("capitalize")(t.title))+" ")])]}))],2)]),e._v(" "),r("div",{staticClass:"kt-subheader__toolbar"},[r("div",{staticClass:"kt-subheader__wrapper"},[r("a",{staticClass:"btn btn-sm btn-elevate btn-brand btn-elevate",attrs:{href:"#",id:"kt_dashboard_daterangepicker","data-toggle":"kt-tooltip",title:"","data-placement":"left","data-original-title":"Йо! Это я, сегодняшняя дата!"}},[r("span",{staticClass:"kt-opacity-7",attrs:{id:"kt_dashboard_daterangepicker_title"}},[e._v("Сегодня:")]),e._v(" \n                    "),r("span",{staticClass:"kt-font-bold",attrs:{id:"kt_dashboard_daterangepicker_date"}},[e._v(e._s(e.monthName)+" "+e._s(e.day))]),e._v(" "),r("i",{staticClass:"flaticon-calendar-with-a-clock-time-tools kt-padding-l-5 kt-padding-r-0"})])])])])])}),[],!1,null,"06a05328",null);t.default=component.exports},429:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var o=r(430),l=r(431),n=function(){function e(){Object(o.a)(this,e),this.errors={}}return Object(l.a)(e,[{key:"get",value:function(e){if(this.errors[e])return this.errors[e][0]}},{key:"record",value:function(e){this.errors=e.errors}}]),e}()},453:function(e,t,r){"use strict";(function(e){r(157),r(31),r(14),r(25);var o=r(3),l=r(433),n=r(428),c=r(429);t.a={middleware:"auth",components:{Breadcrumbs:n.default,"my-upload":l.a},data:function(){return{breadcrumbsItems:[{title:"Platform Users",name:"platform-users"},{title:"Edit",name:"platform-users-id",params:"id: "+this.$route.params.id}],user:{},userDisabled:{},profile:{gender:""},avatar:"",socialLinks:[],newSocial:"",platforms:[],roles:[],types:[],statuses:[],loading:!1,errors:new c.a,editField:"",platformEndpoint:this.$store.state.auth.user.profile.platform.endpoint,optionsGender:["male","female"],show:!1,showPhoto:!1,params:{name:"avatar"},mediaServerUrl:e.env.mediaUrl}},fetch:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$permission(["user_platform_edit"])||e.$router.push({name:"index"}),t.next=3,e.getItemOptionsData();case 3:return t.next=5,e.getItemEditData();case 5:case"end":return t.stop()}}),t)})))()},methods:{getItemEditData:function(){var e=this;this.loading=!0,this.$axios.get("".concat(this.platformEndpoint,"/users/").concat(this.$route.params.id)).then((function(t){var data=t.data.data;e.user=data,console.log(e.user),data.profile&&(e.profile=data.profile,null!==data.profile.avatar&&(e.avatar=data.profile.avatar,e.showPhoto=!0)),e.socialLinks=data.socials})).catch((function(e){console.log(e)})).finally((function(){e.loading=!1}))},getItemOptionsData:function(){var e=this;this.loading=!0,this.$axios.get("".concat(this.platformEndpoint,"/users/update/data")).then((function(t){var data=t.data.data;e.platforms=data.platform,e.roles=data.role,e.types=data.type,e.statuses=data.status})).catch((function(e){console.log(e)})).finally((function(){e.loading=!1}))},update:function(){var e=this;this.loading=!0,this.$axios.$patch("".concat(this.platformEndpoint,"/users/").concat(this.$route.params.id),{name:this.user.name,email:this.user.email,password:this.user.password,type:this.user.type,status:this.user.status,socials:this.socialLinks,profile:{id:this.profile?this.profile.id:"",last_name:this.profile.last_name,gender:this.profile.gender},roles:this.user.role}).then((function(t){var data=t.data;"success"===data.status&&(e.getItemEditData(),e.avatar?e.submitFiles(data.user_id,data.profile_id):e.$message({showClose:!0,message:"Successfully updated",type:"success",center:!0}))})).catch((function(t){return e.errors.record(t.response.data)})).finally((function(){e.loading=!1}))},submitFiles:function(e,t){var r=new FormData;r.append("avatar",this.avatar),r.append("id",e),r.append("item","user"),this.$axios.post(this.mediaServerUrl+"/api/avatar/update/"+e,r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(r){this.afterSubmitSave(r.data.path,e,t),console.log("success")}.bind(this)).catch((function(data){console.log("error")}))},afterSubmitSave:function(data,e,t){var r=this;this.$axios.patch("".concat(this.platformEndpoint,"/users/").concat(e),{profile:{id:t||"",avatar:data}}).then((function(e){r.$message({showClose:!0,message:"Successfully updated",type:"success",center:!0})}))},addSocialLink:function(){this.socialLinks.push({url:""}),this.newSocial=""},removeSocialLink:function(e,t){var r=this;this.socialLinks.splice(e,1),this.$axios.delete("".concat(this.platformEndpoint,"/users/socials/").concat(t)).then((function(e){r.$message({showClose:!0,message:"Successfully deleted",type:"success",center:!0})})).catch((function(e){console.log(e)}))},focusField:function(e){this.editField=e},blurField:function(){this.editField="",this.update()},showField:function(e){return""==this.user[e]||this.editField==e},toggleShow:function(){this.show=!this.show},platformIdToName:function(e,t){this.platforms;var r=e.find((function(p){return p.id===t})).name;this.userDisabled.platform=r},roleIdToName:function(e,t){for(var r=t.length,o=[],l=function(i){var r=e.find((function(p){return p.id===t[i]})).name;o.push(r)},i=0;i<r;i++)l(i);console.log(o),this.userDisabled.role=o},cropSuccess:function(e){this.avatar=e,this.showPhoto=!0,this.update()}}}}).call(this,r(107))},454:function(e,t,r){var content=r(541);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(8).default)("3a9d1471",content,!0,{sourceMap:!1})},540:function(e,t,r){"use strict";var o=r(454);r.n(o).a},541:function(e,t,r){(t=r(7)(!1)).push([e.i,".item__error[data-v-7f063e9f]{color:#f56c6c;font-size:11px;line-height:1;padding-top:4px;position:absolute}",""]),e.exports=t},571:function(e,t,r){"use strict";r.r(t);var o=r(453).a,l=(r(540),r(2)),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Breadcrumbs",{attrs:{title:"Users",items:e.breadcrumbsItems}}),e._v(" "),r("div",{staticClass:"kt-container  kt-container--fluid  kt-grid__item kt-grid__item--fluid"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-12"},[r("div",{staticClass:"kt-portlet"},[r("div",{staticClass:"kt-portlet__head"},[r("div",{staticClass:"kt-portlet__head-label"},[r("n-link",{staticClass:"btn btn-secondary",attrs:{to:{name:"platform-users"}}},[r("i",{staticClass:"fa fa-arrow-left",attrs:{"aria-hidden":"true"}}),e._v("\n                                To table\n                            ")])],1)]),e._v(" "),r("form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"kt-form",attrs:{role:"form"}},[r("div",{staticClass:"kt-portlet__body"},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.showPhoto,expression:"showPhoto"}],staticClass:"row"},[r("div",{staticClass:"col-md-2"},[r("img",{staticStyle:{"border-radius":"50%",width:"100%",height:"auto"},attrs:{src:e.avatar}})])]),e._v(" "),r("br",{directives:[{name:"show",rawName:"v-show",value:e.showPhoto,expression:"showPhoto"}]}),e._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-2"},[r("a",{staticClass:"btn btn-success btn-sm btn-block",staticStyle:{color:"white"},on:{click:e.toggleShow}},[e._v("Set Logo")])]),e._v(" "),r("br"),e._v(" "),r("my-upload",{attrs:{field:"img",width:300,height:300,params:e.params,langType:"en","img-format":"png"},on:{"crop-success":e.cropSuccess},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}})],1),e._v(" "),r("br"),e._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-2"},[r("div",{staticClass:"form-group",on:{mousedown:function(t){return e.focusField("type")}}},[r("el-select",{directives:[{name:"show",rawName:"v-show",value:e.showField("type"),expression:"showField('type')"}],attrs:{filterable:"",placeholder:"Choose Type"},on:{focus:function(t){return e.focusField("type")},change:e.blurField},model:{value:e.user.type,callback:function(t){e.$set(e.user,"type",t)},expression:"user.type"}},e._l(e.types,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1),e._v(" "),r("div",{staticClass:"item__error"},[e._v("\n                                            "+e._s(e.errors.get("type"))+"\n                                        ")]),e._v(" "),r("el-select",{directives:[{name:"show",rawName:"v-show",value:!e.showField("type"),expression:"!showField('type')"}],attrs:{filterable:"",placeholder:"Choose type",disabled:""},model:{value:e.user.type,callback:function(t){e.$set(e.user,"type",t)},expression:"user.type"}})],1)]),e._v(" "),r("div",{staticClass:"col-md-2"},[r("div",{staticClass:"form-group",on:{mousedown:function(t){return e.focusField("status")}}},[r("el-select",{directives:[{name:"show",rawName:"v-show",value:e.showField("status"),expression:"showField('status')"}],attrs:{filterable:"",placeholder:"Choose status"},on:{focus:function(t){return e.focusField("status")},change:e.blurField},model:{value:e.user.status,callback:function(t){e.$set(e.user,"status",t)},expression:"user.status"}},e._l(e.statuses,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1),e._v(" "),r("div",{staticClass:"item__error"},[e._v("\n                                            "+e._s(e.errors.get("status"))+"\n                                        ")]),e._v(" "),r("el-select",{directives:[{name:"show",rawName:"v-show",value:!e.showField("status"),expression:"!showField('status')"}],attrs:{filterable:"",placeholder:"Choose status",disabled:""},model:{value:e.user.status,callback:function(t){e.$set(e.user,"status",t)},expression:"user.status"}})],1)]),e._v(" "),r("div",{staticClass:"col-md-2"},[r("div",{staticClass:"form-group",on:{mousedown:function(t){return e.focusField("gender")}}},[r("el-select",{directives:[{name:"show",rawName:"v-show",value:e.showField("gender"),expression:"showField('gender')"}],attrs:{filterable:"",placeholder:"Choose Gender"},on:{focus:function(t){return e.focusField("gender")},change:e.blurField},model:{value:e.profile.gender,callback:function(t){e.$set(e.profile,"gender",t)},expression:"profile.gender"}},e._l(e.optionsGender,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1),e._v(" "),r("div",{staticClass:"item__error"},[e._v("\n                                            "+e._s(e.errors.get("gender"))+"\n                                        ")]),e._v(" "),r("el-select",{directives:[{name:"show",rawName:"v-show",value:!e.showField("gender"),expression:"!showField('gender')"}],attrs:{filterable:"",placeholder:"Choose gender",disabled:""},model:{value:e.profile.gender,callback:function(t){e.$set(e.profile,"gender",t)},expression:"profile.gender"}})],1)])]),e._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-4"},[r("div",{staticClass:"form-group",on:{click:function(t){return e.focusField("name")}}},[r("label",[e._v("Name")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.name,expression:"user.name"},{name:"show",rawName:"v-show",value:e.showField("name"),expression:"showField('name')"}],class:e.errors.get("name")?"form-control is-invalid":"form-control",attrs:{type:"text",placeholder:"Enter name"},domProps:{value:e.user.name},on:{focus:function(t){return e.focusField("name")},blur:e.blurField,input:function(t){t.target.composing||e.$set(e.user,"name",t.target.value)}}}),e._v(" "),r("div",{staticClass:"invalid-feedback"},[e._v(e._s(e.errors.get("name")))]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.name,expression:"user.name"},{name:"show",rawName:"v-show",value:!e.showField("name"),expression:"!showField('name')"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Enter name",disabled:""},domProps:{value:e.user.name},on:{input:function(t){t.target.composing||e.$set(e.user,"name",t.target.value)}}})])]),e._v(" "),r("div",{staticClass:"col-md-4"},[r("div",{staticClass:"form-group",on:{click:function(t){return e.focusField("email")}}},[r("label",[e._v("Email")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"},{name:"show",rawName:"v-show",value:e.showField("email"),expression:"showField('email')"}],class:e.errors.get("email")?"form-control is-invalid":"form-control",attrs:{type:"email",placeholder:"Enter email"},domProps:{value:e.user.email},on:{focus:function(t){return e.focusField("email")},blur:e.blurField,input:function(t){t.target.composing||e.$set(e.user,"email",t.target.value)}}}),e._v(" "),r("div",{staticClass:"invalid-feedback"},[e._v(e._s(e.errors.get("email")))]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"},{name:"show",rawName:"v-show",value:!e.showField("email"),expression:"!showField('email')"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Enter email",disabled:""},domProps:{value:e.user.email},on:{input:function(t){t.target.composing||e.$set(e.user,"email",t.target.value)}}})])]),e._v(" "),r("div",{staticClass:"col-md-4"},[r("div",{staticClass:"form-group",on:{click:function(t){return e.focusField("password")}}},[r("label",[e._v("Password")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"},{name:"show",rawName:"v-show",value:e.showField("password"),expression:"showField('password')"}],class:e.errors.get("password")?"form-control is-invalid":"form-control",attrs:{type:"text",placeholder:"Enter password",minlength:"8"},domProps:{value:e.user.password},on:{focus:function(t){return e.focusField("password")},blur:e.blurField,input:function(t){t.target.composing||e.$set(e.user,"password",t.target.value)}}}),e._v(" "),r("div",{staticClass:"invalid-feedback"},[e._v(e._s(e.errors.get("password")))]),e._v(" "),r("input",{directives:[{name:"show",rawName:"v-show",value:!e.showField("password"),expression:"!showField('password')"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Edit password field to set new password",minlength:"8",disabled:""}})])])]),e._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-4"},[r("div",{staticClass:"form-group",on:{click:function(t){return e.focusField("last_name")}}},[r("label",[e._v("Last name")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.profile.last_name,expression:"profile.last_name"},{name:"show",rawName:"v-show",value:e.showField("last_name"),expression:"showField('last_name')"}],class:e.errors.get("last_name")?"form-control is-invalid":"form-control",attrs:{type:"text",placeholder:"Enter last name"},domProps:{value:e.profile.last_name},on:{focus:function(t){return e.focusField("last_name")},blur:e.blurField,input:function(t){t.target.composing||e.$set(e.profile,"last_name",t.target.value)}}}),e._v(" "),r("div",{staticClass:"invalid-feedback"},[e._v(e._s(e.errors.get("last_name")))]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.profile.last_name,expression:"profile.last_name"},{name:"show",rawName:"v-show",value:!e.showField("last_name"),expression:"!showField('last_name')"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Enter last name",minlength:"8",disabled:""},domProps:{value:e.profile.last_name},on:{input:function(t){t.target.composing||e.$set(e.profile,"last_name",t.target.value)}}})])])]),e._v(" "),r("hr"),e._v(" "),r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-md-1 col-form-label"},[e._v(" Social links")]),e._v(" "),r("div",{staticClass:"col-md-5"},[r("div",{staticClass:"kt-repeater"},[r("div",{attrs:{"data-repeater-list":"demo1"}},e._l(e.socialLinks,(function(t,o){return r("div",{key:t.id,staticClass:"kt-repeater__item",attrs:{"data-repeater-item":""}},[r("div",{staticClass:"input-group"},[e._m(0,!0),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.url,expression:"socialLink.url"}],class:e.errors.get("socials."+o+".url")?"form-control is-invalid":"form-control",attrs:{type:"text",placeholder:"Enter social url"},domProps:{value:t.url},on:{blur:e.blurField,input:function(r){r.target.composing||e.$set(t,"url",r.target.value)}}}),e._v(" "),r("div",{staticClass:"invalid-feedback"},[e._v(e._s(e.errors.get("socials."+o+".url")))]),e._v(" "),r("div",{staticClass:"input-group-append"},[r("button",{staticClass:"btn btn-danger btn-icon",attrs:{"data-repeater-delete":""},on:{click:function(r){return e.removeSocialLink(o,t.id)}}},[r("i",{staticClass:"la la-close kt-font-light"})])])]),e._v(" "),r("div",{staticClass:"kt-separator kt-separator--space-sm"})])})),0),e._v(" "),r("div",{staticClass:"kt-repeater__add-data"},[r("span",{staticClass:"btn btn-info btn-sm",attrs:{"data-repeater-create":""},on:{click:e.addSocialLink}},[r("i",{staticClass:"la la-plus"}),e._v(" Add\n                                    ")])])])])])])])])])])])],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"input-group-prepend"},[t("span",{staticClass:"input-group-text"},[t("i",{staticClass:"la la-chain"})])])}],!1,null,"7f063e9f",null);t.default=component.exports;installComponents(component,{Breadcrumbs:r(428).default})}}]);